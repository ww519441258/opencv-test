(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{"278":function(e,t,n){var r,o,a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};a=function(){"use strict";var e="millisecond",t="second",n="minute",r="hour",o="day",a="week",i="month",s="year",c=/^(\d{4})-?(\d{1,2})-?(\d{0,2})(.*?(\d{1,2}):(\d{1,2}):(\d{1,2}))?.?(\d{1,3})?$/,u=/\[.*?\]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l={"name":"en","weekdays":"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),"months":"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p=function d(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},f={"padStart":p,"padZoneStr":function padZoneStr(e){var t=Math.abs(e),n=Math.floor(t/60),r=t%60;return(e<=0?"+":"-")+p(n,2,"0")+":"+p(r,2,"0")},"monthDiff":function monthDiff(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months"),o=t-r<0,a=e.clone().add(n+(o?-1:1),"months");return Number(-(n+(t-r)/(o?r-a:a-r)))},"absFloor":function absFloor(e){return e<0?Math.ceil(e)||0:Math.floor(e)},"prettyUnit":function prettyUnit(c){return{"M":i,"y":s,"w":a,"d":o,"h":r,"m":n,"s":t,"ms":e}[c]||String(c||"").toLowerCase().replace(/s$/,"")},"isUndefined":function isUndefined(e){return void 0===e}},b="en",_={};_[b]=l;var k=function m(e){return e instanceof D},v=function y(e,t,n){var r;if(!e)return null;if("string"==typeof e)_[e]&&(r=e),t&&(_[e]=t,r=e);else{var o=e.name;_[o]=e,r=o}return n||(b=r),r},g=function M(e,t){if(k(e))return e.clone();var n=t||{};return n.date=e,new D(n)},w=function S(e,t){return g(e,{"locale":t.$L})},O=f;O.parseLocale=v,O.isDayjs=k,O.wrapper=w;var D=function(){function h(e){this.parse(e)}var l=h.prototype;return l.parse=function(e){var t,n;this.$d=null===(t=e.date)?new Date(NaN):O.isUndefined(t)?new Date:t instanceof Date?t:"string"==typeof t&&/.*[^Z]$/i.test(t)&&(n=t.match(c))?new Date(n[1],n[2]-1,n[3]||1,n[5]||0,n[6]||0,n[7]||0,n[8]||0):new Date(t),this.init(e)},l.init=function(e){this.$y=this.$d.getFullYear(),this.$M=this.$d.getMonth(),this.$D=this.$d.getDate(),this.$W=this.$d.getDay(),this.$H=this.$d.getHours(),this.$m=this.$d.getMinutes(),this.$s=this.$d.getSeconds(),this.$ms=this.$d.getMilliseconds(),this.$L=this.$L||v(e.locale,null,!0)||b},l.$utils=function(){return O},l.isValid=function(){return!("Invalid Date"===this.$d.toString())},l.$compare=function(e){return this.valueOf()-g(e).valueOf()},l.isSame=function(e){return 0===this.$compare(e)},l.isBefore=function(e){return this.$compare(e)<0},l.isAfter=function(e){return this.$compare(e)>0},l.year=function(){return this.$y},l.month=function(){return this.$M},l.day=function(){return this.$W},l.date=function(){return this.$D},l.hour=function(){return this.$H},l.minute=function(){return this.$m},l.second=function(){return this.$s},l.millisecond=function(){return this.$ms},l.unix=function(){return Math.floor(this.valueOf()/1e3)},l.valueOf=function(){return this.$d.getTime()},l.startOf=function(e,c){var u=this,l=!!O.isUndefined(c)||c,p=function d(e,t){var n=w(new Date(u.$y,t,e),u);return l?n:n.endOf(o)},f=function $(e,t){return w(u.toDate()[e].apply(u.toDate(),l?[0,0,0,0].slice(t):[23,59,59,999].slice(t)),u)};switch(O.prettyUnit(e)){case s:return l?p(1,0):p(31,11);case i:return l?p(1,this.$M):p(0,this.$M+1);case a:return p(l?this.$D-this.$W:this.$D+(6-this.$W),this.$M);case o:case"date":return f("setHours",0);case r:return f("setMinutes",1);case n:return f("setSeconds",2);case t:return f("setMilliseconds",3);default:return this.clone()}},l.endOf=function(e){return this.startOf(e,!1)},l.$set=function(a,c){switch(O.prettyUnit(a)){case o:this.$d.setDate(this.$D+(c-this.$W));break;case"date":this.$d.setDate(c);break;case i:this.$d.setMonth(c);break;case s:this.$d.setFullYear(c);break;case r:this.$d.setHours(c);break;case n:this.$d.setMinutes(c);break;case t:this.$d.setSeconds(c);break;case e:this.$d.setMilliseconds(c)}return this.init(),this},l.set=function(e,t){return this.clone().$set(e,t)},l.add=function(e,c){var u=this;e=Number(e);var l,p=O.prettyUnit(c),f=function $(t,n){var r=u.set("date",1).set(t,n+e);return r.set("date",Math.min(u.$D,r.daysInMonth()))};if(p===i)return f(i,this.$M);if(p===s)return f(s,this.$y);switch(p){case n:l=6e4;break;case r:l=36e5;break;case o:l=864e5;break;case a:l=6048e5;break;case t:l=1e3;break;default:l=1}var d=this.valueOf()+e*l;return w(d,this)},l.subtract=function(e,t){return this.add(-1*e,t)},l.format=function(e){var t=this,n=e||"YYYY-MM-DDTHH:mm:ssZ",r=O.padZoneStr(this.$d.getTimezoneOffset()),o=this.$locale(),a=o.weekdays,i=o.months,s=function u(e,t,n,r){return e&&e[t]||n[t].substr(0,r)};return n.replace(u,function(e){if(e.indexOf("[")>-1)return e.replace(/\[|\]/g,"");switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return String(t.$y);case"M":return String(t.$M+1);case"MM":return O.padStart(t.$M+1,2,"0");case"MMM":return s(o.monthsShort,t.$M,i,3);case"MMMM":return i[t.$M];case"D":return String(t.$D);case"DD":return O.padStart(t.$D,2,"0");case"d":return String(t.$W);case"dd":return s(o.weekdaysMin,t.$W,a,2);case"ddd":return s(o.weekdaysShort,t.$W,a,3);case"dddd":return a[t.$W];case"H":return String(t.$H);case"HH":return O.padStart(t.$H,2,"0");case"h":case"hh":return 0===t.$H?12:O.padStart(t.$H<13?t.$H:t.$H-12,"hh"===e?2:1,"0");case"a":return t.$H<12?"am":"pm";case"A":return t.$H<12?"AM":"PM";case"m":return String(t.$m);case"mm":return O.padStart(t.$m,2,"0");case"s":return String(t.$s);case"ss":return O.padStart(t.$s,2,"0");case"SSS":return O.padStart(t.$ms,3,"0");case"Z":return r;default:return r.replace(":","")}})},l.diff=function(e,c,u){var l=O.prettyUnit(c),p=g(e),f=this-p,d=O.monthDiff(this,p);switch(l){case s:d/=12;break;case i:break;case"quarter":d/=3;break;case a:d=f/6048e5;break;case o:d=f/864e5;break;case r:d=f/36e5;break;case n:d=f/6e4;break;case t:d=f/1e3;break;default:d=f}return u?d:O.absFloor(d)},l.daysInMonth=function(){return this.endOf(i).$D},l.$locale=function(){return _[this.$L]},l.locale=function(e,t){var n=this.clone();return n.$L=v(e,t,!0),n},l.clone=function(){return w(this.toDate(),this)},l.toDate=function(){return new Date(this.$d)},l.toArray=function(){return[this.$y,this.$M,this.$D,this.$H,this.$m,this.$s,this.$ms]},l.toJSON=function(){return this.toISOString()},l.toISOString=function(){return this.toDate().toISOString()},l.toObject=function(){return{"years":this.$y,"months":this.$M,"date":this.$D,"hours":this.$H,"minutes":this.$m,"seconds":this.$s,"milliseconds":this.$ms}},l.toString=function(){return this.$d.toUTCString()},h}();return g.extend=function(e,t){return e(t,D,g),g},g.locale=v,g.isDayjs=k,g.en=_[b],g},"object"==i(t)&&void 0!==e?e.exports=a():void 0===(o="function"==typeof(r=a)?r.call(t,n,t,e):r)||(e.exports=o)},"292":function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r,o,a=n(1),i=n(2),s=n(51),c=n(240),u=n.n(c),l=n(10),p=n.n(l),f=(n(293),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var d=(o=r=function(e){function Popup(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Popup);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Popup.__proto__||Object.getPrototypeOf(Popup)).call(this,e));return t.state={},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Popup,i["a"].Component),f(Popup,[{"key":"render","value":function render(){var e=this.props,t=e.isShow,n=e.cannontClose,r=e.autoWidth,o=e.onHide,i=void 0;return t&&(i=a.k.createElement(s.a,null,a.k.createElement(s.a,{"className":"shade","onClick":o}),a.k.createElement(s.a,{"className":p()("popup-modal",{"auto-width":r})},this.props.children),!n&&a.k.createElement(s.a,{"className":"iconfont icon-close","onClick":o}))),a.k.createElement(s.a,{"className":"popup"},i)}}]),Popup}(),r.options={"addGlobalClass":!0},r.defaultProps={"isShow":!1,"cannotClose":!1,"autoWidth":!1,"onHide":function onHide(){}},r.propTypes={"isShow":u.a.bool,"cannotClose":u.a.bool,"autoWidth":u.a.bool,"onHide":u.a.func},o)},"293":function(e,t,n){},"295":function(e,t,n){"use strict";n.d(t,"a",function(){return $});var r,o,a=n(1),i=n(236),s=n(2),c=n(51),u=n(259),l=n(291),p=n(240),f=n.n(p),d=n(278),h=n.n(d),m=(n(296),n(77)),y=n(3),b=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var $=(o=r=function(e){function Coupon(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Coupon);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Coupon.__proto__||Object.getPrototypeOf(Coupon)).call(this,e));return t.handleClickCoupon=function(){var e=t.props,n=e.couponInfo,r=e.onClick;"take"===e.mode&&t.takeCoupon(n),r(n)},t.state={},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Coupon,s["a"].Component),b(Coupon,[{"key":"takeCoupon","value":function(){var e=function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,o){try{var a=t[r](o),i=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(e){var t,n,r,o;return regeneratorRuntime.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(m.b)({"name":"takeCoupon","data":{"couponId":e.id}});case 2:if(t=a.sent,n=t.json,a.prev=4,!n){a.next=9;break}return r=n.cardId,o=n.cardExt,a.next=9,Object(i.a)({"cardList":[{"cardId":r,"cardExt":JSON.stringify(o)}]});case 9:Object(y.c)("领取成功"),s.a.eventCenter.trigger("update:userCenter"),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(4),console.log("takeCouponFail: ",a.t0);case 16:case"end":return a.stop()}},_callee,this,[[4,13]])}));return function takeCoupon(t){return e.apply(this,arguments)}}()},{"key":"render","value":function render(){var e=this.props,t=e.couponInfo,n=e.mode,r=void 0,o=t.couponInfo||t,i=o.limit_id,s=o.type,p=o.description,f=o.favorable_content,d=o.least_cost,h=o.fixed_begin_term,m=void 0===h?0:h,y=o.fixed_term,b=void 0===y?0:y,$=t.begin_at||(t.couponInfo?t.couponInfo.begin_time:t.begin_time),_=t.end_at||(t.couponInfo?t.couponInfo.end_time:t.end_time);1===s?r=a.k.createElement(c.a,{"className":"coupon__left"},a.k.createElement(c.a,{"className":"number"},"￥",f),d&&a.k.createElement(c.a,{"className":"desc"},"满",d,"元可用")):2===s&&(r=a.k.createElement(c.a,{"className":"coupon__left"},a.k.createElement(c.a,{"className":"number"},a.k.createElement(u.a,null,(100-f)/10),a.k.createElement(u.a,null,"折")),d&&a.k.createElement(c.a,{"className":"desc"},"满",d,"元可用")));var k=i&&i.replace(/^.*【(.*)】.*$/,"$1"),v=k&&(k.length>15?i.replace(/【.*】/,"【"+k.substr(0,15)+"...】"):i);return a.k.createElement(c.a,{"className":"coupon"},a.k.createElement(c.a,{"className":"saw-tooth-bar"},Object.keys(Array.from({"length":6})).map(function(e){return a.k.createElement(c.a,{"key":e,"className":"tooth"})})),r,a.k.createElement(c.a,{"className":"coupon__right"},a.k.createElement(c.a,{"className":"gap-group"},a.k.createElement(c.a,{"className":"gap__left"}),a.k.createElement(c.a,{"className":"gap__right"})),a.k.createElement(c.a,{"className":"main"},a.k.createElement(c.a,{"className":"name"},v),a.k.createElement(c.a,{"className":"date"},$?a.k.createElement(u.a,null,formatTime($)," 至 ",formatTime(_)):a.k.createElement(l.a,null,m>0&&a.k.createElement(u.a,{"style":{"marginRight":"5px"}},"领取",m,"天后有效"),b>0&&a.k.createElement(u.a,null,m<=0?"领取后":"","有效期",b,"天"))),a.k.createElement(c.a,{"className":"desc"},p)),"display"!==n&&a.k.createElement(c.a,{"className":"coupon__btn"},a.k.createElement(c.a,{"className":"btn","onClick":this.handleClickCoupon},"take"===n?"领取":"使用"))))}}]),Coupon}(),r.options={"addGlobalClass":!0},r.defaultProps={"couponInfo":{},"mode":"take","onClick":function onClick(){}},r.propTypes={"couponInfo":f.a.object.isRequired,"mode":f.a.oneOf(["take","use","display"]),"onClick":f.a.func},o);function formatTime(e){return e?Number.isNaN(1*e)?e.replace(/-/g,"."):h()(10===e.length?1e3*e:e).format("YYYY.MM.DD hh:mm:ss"):""}},"296":function(e,t,n){},"336":function(e,t,n){},"497":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return b});var r,o,a=n(1),i=n(11),s=n(2),c=n(51),u=n(260),l=(n(336),n(77)),p=n(333),f=n(292),d=n(295),h=n(241),m=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),y=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:get(o,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0};var b=(o=r=function(e){function Index(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Index);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Index.__proto__||Object.getPrototypeOf(Index)).call(this,e));return t.hideCouponTip=function(){t.setState({"isShowCouponTip":!1})},t.state={"isShowCouponTip":!1,"couponInfo":null},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Index,s["a"].Component),m(Index,[{"key":"onShareAppMessage","value":function onShareAppMessage(){}},{"key":"componentWillMount","value":function(){var e=function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,o){try{var a=t[r](o),i=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(){var e,t,n,r,o,a,s;return regeneratorRuntime.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(e=this.$router.params,console.log("page params: ",e),n=(t=e||{}).scene,r=t.card_id,o=t.encrypt_code,n&&(Object(i.c)("hasBoundUpper")||Object(l.b)({"name":"binding","data":{"data":n},"success":function success(){Object(i.e)("hasBoundUpper",!0)},"fail":function fail(e){e&&"您已绑定上级，不能再次绑定噢"===e.info&&Object(i.e)("hasBoundUpper",!0)},"hideToast":!0})),!r||!o){c.next=12;break}return this.setState({"isShowCouponTip":!0}),c.next=8,Object(l.b)({"name":"getCouponInfo","data":{"cardId":r,"encryptCode":o}});case 8:a=c.sent,s=a.coupon,this.setState({"couponInfo":s}),Object(i.e)("couponIdFromEntry",s.id);case 12:case"end":return c.stop()}},_callee,this)}));return function componentWillMount(){return e.apply(this,arguments)}}()},{"key":"onPullDownRefresh","value":function onPullDownRefresh(){s.a.eventCenter.trigger("reload:home")}},{"key":"render","value":function render(){var e=this,t=this.state,n=t.isShowCouponTip,r=t.couponInfo,o=a.k.createElement(c.a,{"className":"index"},a.k.createElement(p.a,{"pageId":1,"isHomePage":!0,"event":"home"}),!1,a.k.createElement(f.a,{"isShow":n,"onHide":this.hideCouponTip},a.k.createElement(c.a,{"className":"coupon-tip--tittle"},"卡包的优惠券已可在商城使用"),r?a.k.createElement(d.a,{"couponInfo":r,"mode":"display"}):a.k.createElement(h.a,{"type":"inline"})));return a.k.createElement(u.a,{"onRefresh":this.onPullDownRefresh&&this.onPullDownRefresh.bind(this),"ref":function ref(t){t&&(e.pullDownRefreshRef=t)}},o)}},{"key":"componentDidMount","value":function componentDidMount(){y(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidMount",this)&&y(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidMount",this).call(this)}},{"key":"componentDidShow","value":function componentDidShow(){y(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidShow",this)&&y(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidShow",this).call(this),this.pullDownRefreshRef&&this.pullDownRefreshRef.bindEvent()}},{"key":"componentDidHide","value":function componentDidHide(){y(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidHide",this)&&y(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidHide",this).call(this),this.pullDownRefreshRef&&this.pullDownRefreshRef.unbindEvent()}}]),Index}(),r.config={"navigationBarTitleText":"首页"},o)}}]);