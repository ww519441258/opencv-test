(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"241":function(e,t,n){"use strict";n.d(t,"a",function(){return m});var o,a,r=n(1),i=n(2),c=n(51),s=n(10),l=n.n(s),u=n(240),p=n.n(u),f=(n(242),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var m=(a=o=function(e){function loading(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,loading);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(loading.__proto__||Object.getPrototypeOf(loading)).call(this,e));return t.state={},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(loading,i["a"].Component),f(loading,[{"key":"render","value":function render(){var e=this.props,t=e.type,n=e.display,o=e.tipText,a=l()("loading",t,n);return r.k.createElement(c.a,{"className":a},r.k.createElement(c.a,{"className":"circle"}),r.k.createElement(c.a,{"className":"text"},o,"..."))}}]),loading}(),o.options={"addGlobalClass":!0},o.propTypes={"type":p.a.oneOf(["center","block","inline"]),"display":p.a.oneOf(["dark","light"]),"tipText":p.a.string},o.defaultProps={"type":"center","display":"dark","tipText":"加载中"},a)},"242":function(e,t,n){},"253":function(e,t,n){"use strict";n.d(t,"a",function(){return m});var o,a,r=n(1),i=n(2),c=n(124),s=n(51),l=n(258),u=n(240),p=n.n(u),f=(n(254),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var m=(a=o=function(e){function Tip(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Tip);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Tip.__proto__||Object.getPrototypeOf(Tip)).call(this,e));return t.onClickButtonHandle=function(){var e=t.props,n=e.mainActionType,o=e.onClickMain;"back"===n?i.a.navigateBack():"home"===n?"WEAPP"===i.a.getEnv()?Object(c.d)({"url":"/pages/index/index"}):(i.a.redirectTo({"url":"/pages/index/index"}),window.location.reload()):"custom"===n&&o()},t.state={},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Tip,i["a"].Component),f(Tip,[{"key":"render","value":function render(){var e=this.props,t=e.type,n=e.icon,o=e.text,a=e.mainAction,i=e.height,c=e.mainActionType;return r.k.createElement(s.a,{"className":"tip "+t,"style":{"height":i}},r.k.createElement(s.a,{"className":"tip__content"},r.k.createElement(s.a,{"className":"iconfont icon-"+n}),r.k.createElement(s.a,{"className":"tip__text"},o),"none"!==c&&""!==a&&r.k.createElement(l.a,{"type":"primary","onClick":this.onClickButtonHandle},a)))}}]),Tip}(),o.options={"addGlobalClass":!0},o.defaultProps={"type":"auto","icon":"empty","text":"当前没有数据","height":"100%","mainAction":"返回上一级","mainActionType":"back"},a);m.propTypes={"type":p.a.oneOf(["full","auto"]),"icon":p.a.string,"text":p.a.string,"mainAction":p.a.string,"mainActionType":p.a.oneOf(["back","home","custom","none"]),"height":p.a.string,"onClickMain":p.a.func}},"254":function(e,t,n){},"268":function(e,t,n){"use strict";n.d(t,"a",function(){return v});var o,a,r=n(1),i=n(2),c=n(51),s=n(280),l=n(10),u=n.n(l),p=n(240),f=n.n(p),m=(n(269),n(77)),d=n(241),h=n(253),b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},y=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var v=(a=o=function(e){function List(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,List);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(List.__proto__||Object.getPrototypeOf(List)).call(this,e));return t.getData=function(){if(!t.loading&&!t.isFinished&&!t.showLoading){var e=t.apiName,n=t.params;t.loading=!0,Object(m.b)({"name":e,"data":b({"page":t.page++},n),"success":function success(e){var n=Array.isArray(e)?e:e.data||e.order,o=t.listData;o||(o=[]),o=o.concat(n),t.listData=o,t.props.onLoadData(o,e),0===o.length&&0===n.length&&t.setState({"isEmpty":!0}),n.length<t.props.numberPerPage&&(t.isFinished=!0,t.setState({"showLoading":!1})),t.loading=!1}})}},t.refreshData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.apiName,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.params;t.isFinished=!1,t.loading=!1,t.page=0,t.listData=[],t.apiName=e,t.params=n,t.setState({"showLoading":!0,"isEmpty":!1}),t.getData()},t.onClickButtonHandle=function(){t.props.onClickButton?t.props.onClickButton():i.a.navigateBack()},t.onScroll=function(e){var n=e.detail,o=n.scrollTop;n.scrollHeight-o<800&&t.getData()},t.page=0,t.isFinished=!1,t.loading=!1,t.listData=[],t.apiName="",t.params={},t.state={"isEmpty":!1,"showLoading":!0},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(List,i["a"].Component),y(List,[{"key":"componentWillMount","value":function componentWillMount(){var e=this,t=this.props,n=t.event,o=t.onMount;i.a.eventCenter.on("load:"+n,function(){e.getData()}),i.a.eventCenter.on("reload:"+n,function(t,n){e.refreshData(t,n)}),o()}},{"key":"componentWillUnmount","value":function componentWillUnmount(){var e=this.props.event;i.a.eventCenter.off("load:"+e),i.a.eventCenter.off("reload:"+e)}},{"key":"render","value":function render(){var e=this.listData,t=void 0;this.willReload&&(this.willReload=!1),t=e.length>0?r.k.createElement(c.a,null,r.k.createElement(s.a,{"scrollY":!0,"onScroll":this.onScroll,"className":"scroll-content"},this.props.children,e&&this.state.showLoading&&r.k.createElement(d.a,{"type":"inline"}))):this.state.isEmpty?r.k.createElement(h.a,{"icon":"empty","text":this.props.emptyTip,"mainActionType":"back","mainAction":this.props.buttonText,"onClickMain":this.onClickButtonHandle,"type":"full"===this.props.mode?"full":"auto"}):r.k.createElement(d.a,{"type":"block"===this.props.mode?"block":void 0});var n=u()("list",{"block":"block"===this.props.mode,"empty":this.state.isEmpty,"full":"full"===this.props.mode});return r.k.createElement(c.a,{"className":n},t)}}]),List}(),o.options={"addGlobalClass":!0},o.defaultProps={"event":"page","apiName":"","numberPerPage":10,"data":{},"emptyTip":"没有内容","buttonText":"返回上一级","mode":"full","onLoadData":function onLoadData(){},"onMount":function onMount(){}},o.propTypes={"event":f.a.string,"numberPerPage":f.a.number,"emptyTip":f.a.string,"buttonText":f.a.string,"mode":f.a.string,"onLoadData":f.a.func,"onMount":f.a.func},a)},"269":function(e,t,n){},"272":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var o,a,r=n(1),i=n(2),c=n(51),s=(n(273),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var l=(a=o=function(e){function Tabs(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Tabs);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Tabs.__proto__||Object.getPrototypeOf(Tabs)).call(this,e));return t.onChange=function(e){e!==t.props.active&&t.props.onChange(e)},t.state={},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Tabs,i["a"].Component),s(Tabs,[{"key":"render","value":function render(){var e=this,t=this.props.tabs.map(function(t,n){return r.k.createElement(c.a,{"key":n,"className":n===e.props.active?"active":"","onClick":e.onChange.bind(void 0,n)},t)});return r.k.createElement(c.a,{"className":"tabs"},r.k.createElement(c.a,{"className":"nav-tabs"},t),r.k.createElement(c.a,{"className":"content"},this.props.children))}}]),Tabs}(),o.options={"addGlobalClass":!0},o.defaultProps={"active":0,"tabs":[],"children":void 0,"onChange":function onChange(){}},a)},"273":function(e,t,n){},"295":function(e,t,n){"use strict";n.d(t,"a",function(){return v});var o,a,r=n(1),i=n(236),c=n(2),s=n(51),l=n(259),u=n(291),p=n(240),f=n.n(p),m=n(278),d=n.n(m),h=(n(296),n(77)),b=n(3),y=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var v=(a=o=function(e){function Coupon(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Coupon);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Coupon.__proto__||Object.getPrototypeOf(Coupon)).call(this,e));return t.handleClickCoupon=function(){var e=t.props,n=e.couponInfo,o=e.onClick;"take"===e.mode&&t.takeCoupon(n),o(n)},t.state={},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Coupon,c["a"].Component),y(Coupon,[{"key":"takeCoupon","value":function(){var e=function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(o,a){try{var r=t[o](a),i=r.value}catch(e){return void n(e)}if(!r.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(e){var t,n,o,a;return regeneratorRuntime.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(h.b)({"name":"takeCoupon","data":{"couponId":e.id}});case 2:if(t=r.sent,n=t.json,r.prev=4,!n){r.next=9;break}return o=n.cardId,a=n.cardExt,r.next=9,Object(i.a)({"cardList":[{"cardId":o,"cardExt":JSON.stringify(a)}]});case 9:Object(b.c)("领取成功"),c.a.eventCenter.trigger("update:userCenter"),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(4),console.log("takeCouponFail: ",r.t0);case 16:case"end":return r.stop()}},_callee,this,[[4,13]])}));return function takeCoupon(t){return e.apply(this,arguments)}}()},{"key":"render","value":function render(){var e=this.props,t=e.couponInfo,n=e.mode,o=void 0,a=t.couponInfo||t,i=a.limit_id,c=a.type,p=a.description,f=a.favorable_content,m=a.least_cost,d=a.fixed_begin_term,h=void 0===d?0:d,b=a.fixed_term,y=void 0===b?0:b,v=t.begin_at||(t.couponInfo?t.couponInfo.begin_time:t.begin_time),g=t.end_at||(t.couponInfo?t.couponInfo.end_time:t.end_time);1===c?o=r.k.createElement(s.a,{"className":"coupon__left"},r.k.createElement(s.a,{"className":"number"},"￥",f),m&&r.k.createElement(s.a,{"className":"desc"},"满",m,"元可用")):2===c&&(o=r.k.createElement(s.a,{"className":"coupon__left"},r.k.createElement(s.a,{"className":"number"},r.k.createElement(l.a,null,(100-f)/10),r.k.createElement(l.a,null,"折")),m&&r.k.createElement(s.a,{"className":"desc"},"满",m,"元可用")));var k=i&&i.replace(/^.*【(.*)】.*$/,"$1"),_=k&&(k.length>15?i.replace(/【.*】/,"【"+k.substr(0,15)+"...】"):i);return r.k.createElement(s.a,{"className":"coupon"},r.k.createElement(s.a,{"className":"saw-tooth-bar"},Object.keys(Array.from({"length":6})).map(function(e){return r.k.createElement(s.a,{"key":e,"className":"tooth"})})),o,r.k.createElement(s.a,{"className":"coupon__right"},r.k.createElement(s.a,{"className":"gap-group"},r.k.createElement(s.a,{"className":"gap__left"}),r.k.createElement(s.a,{"className":"gap__right"})),r.k.createElement(s.a,{"className":"main"},r.k.createElement(s.a,{"className":"name"},_),r.k.createElement(s.a,{"className":"date"},v?r.k.createElement(l.a,null,formatTime(v)," 至 ",formatTime(g)):r.k.createElement(u.a,null,h>0&&r.k.createElement(l.a,{"style":{"marginRight":"5px"}},"领取",h,"天后有效"),y>0&&r.k.createElement(l.a,null,h<=0?"领取后":"","有效期",y,"天"))),r.k.createElement(s.a,{"className":"desc"},p)),"display"!==n&&r.k.createElement(s.a,{"className":"coupon__btn"},r.k.createElement(s.a,{"className":"btn","onClick":this.handleClickCoupon},"take"===n?"领取":"使用"))))}}]),Coupon}(),o.options={"addGlobalClass":!0},o.defaultProps={"couponInfo":{},"mode":"take","onClick":function onClick(){}},o.propTypes={"couponInfo":f.a.object.isRequired,"mode":f.a.oneOf(["take","use","display"]),"onClick":f.a.func},a);function formatTime(e){return e?Number.isNaN(1*e)?e.replace(/-/g,"."):d()(10===e.length?1e3*e:e).format("YYYY.MM.DD hh:mm:ss"):""}},"296":function(e,t,n){},"470":function(e,t,n){},"524":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return d});var o=n(1),a=n(2),r=n(328),i=n(51),c=n(259),s=n(260),l=(n(470),n(272)),u=n(295),p=n(268),f=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),m=function get(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var a=Object.getPrototypeOf(e);return null===a?void 0:get(a,t,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0};var d=function(e){function OwnCoupon(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OwnCoupon);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(OwnCoupon.__proto__||Object.getPrototypeOf(OwnCoupon)).call(this,e));return t.config={"navigationBarTitleText":"我的优惠券"},t.reload=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.state.activeTab;a.a.eventCenter.trigger("reload:ownCouponList","getMyCoupon",{"status":[1,2,3,0][e]})},t.load=function(){a.a.eventCenter.trigger("load:ownCouponList")},t.onChangeTab=function(e){t.state.activeTab!==e&&(t.setState({"activeTab":e}),t.reload(e))},t.onLoadData=function(e){t.setState({"couponList":e})},t.state={"couponList":null,"activeTab":0},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(OwnCoupon,a["a"].Component),f(OwnCoupon,[{"key":"componentDidMount","value":function componentDidMount(){this.reload(0)}},{"key":"onShareAppMessage","value":function onShareAppMessage(){}},{"key":"onPullDownRefresh","value":function onPullDownRefresh(){this.reload()}},{"key":"onReachBottom","value":function onReachBottom(){this.load()}},{"key":"render","value":function render(){var e=this,t=this.state,n=t.couponList,a=t.activeTab,r=o.k.createElement(i.a,{"className":"own-coupon"},o.k.createElement(i.a,{"className":"coupon-tip"},"此处只显示",o.k.createElement(c.a,{"className":"label"},"系统卡券"),"，",o.k.createElement(c.a,{"className":"label"},"微信卡券"),"请到",o.k.createElement(c.a,{"className":"label"},"微信主界面 → 我 → 卡包"),"查看"),o.k.createElement(l.a,{"tabs":["未使用","已线上使用","已线下使用","已过期"],"active":a,"onChange":this.onChangeTab},o.k.createElement(p.a,{"event":"ownCouponList","emptyTip":"当前没有优惠券","onLoadData":this.onLoadData},n&&n.map(function(e){return o.k.createElement(u.a,{"key":e.id,"couponInfo":e,"mode":"display"})}))));return o.k.createElement(s.a,{"onRefresh":this.onPullDownRefresh&&this.onPullDownRefresh.bind(this),"ref":function ref(t){t&&(e.pullDownRefreshRef=t)}},r)}},{"key":"componentDidShow","value":function componentDidShow(){m(OwnCoupon.prototype.__proto__||Object.getPrototypeOf(OwnCoupon.prototype),"componentDidShow",this)&&m(OwnCoupon.prototype.__proto__||Object.getPrototypeOf(OwnCoupon.prototype),"componentDidShow",this).call(this),this._offReachBottom=Object(r.a)({"callback":this.onReachBottom,"ctx":this,"onReachBottomDistance":void 0}),this.pullDownRefreshRef&&this.pullDownRefreshRef.bindEvent()}},{"key":"componentDidHide","value":function componentDidHide(){m(OwnCoupon.prototype.__proto__||Object.getPrototypeOf(OwnCoupon.prototype),"componentDidHide",this)&&m(OwnCoupon.prototype.__proto__||Object.getPrototypeOf(OwnCoupon.prototype),"componentDidHide",this).call(this),this._offReachBottom&&this._offReachBottom(),this.pullDownRefreshRef&&this.pullDownRefreshRef.unbindEvent()}}]),OwnCoupon}()}}]);