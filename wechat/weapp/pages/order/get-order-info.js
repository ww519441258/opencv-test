"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOrderInfoForVerifying=void 0;var getOrderInfoForVerifying=exports.getOrderInfoForVerifying=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function e(r){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_ajax2.default)({name:"getVerifyInfo",data:{orderId:r},success:function(e){t.setState({orderInfo:e})},fail:function(e){t.setState({tip:e.data.info})},hideToast:!0}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return r.apply(this,arguments)}}(),getOrderInfo=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function e(r){var t,n,i,a,o,s,u,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.orderInfo,i=t.coupon,a=this.$router.params.id,o=n&&n.order.id||a,r&&this.setState({orderInfo:null}),e.prev=4,e.next=7,_index2.default.ajax({name:"getOrderDetail",data:{id:o}});case 7:return s=e.sent,this.originalOrderInfo=JSON.parse(JSON.stringify(s)),r&&s.userMsg.name&&this.setState({name:s.userMsg.name,tel:s.userMsg.mobile}),0!==s.order.order_status||s.order.picking_site||(s.order.picking_site=s.pickingSite),0!==s.order.order_status||this.state.shippingTypes||getShippingTypes.bind(this)(),i&&0===s.order.order_status&&(s.order=Object.assign(s.order,this.handleCoupon(i))),this.setState({orderInfo:s}),u=(0,_orderStatus.getStatus)(s.order),(d=_index2.default.getCurrentPages())&&"pages/order/order"===d[d.length-1].route&&("未确认"===(0,_orderStatus.getStatus)(s.order)?_index2.default.setNavigationBarTitle({title:"确认订单"}):_index2.default.setNavigationBarTitle({title:"订单详情"})),2!==s.order.order_type||"待发货"!==u&&"待收货"!==u&&"已完成"!==u?_index2.default.hideShareMenu():_index2.default.showShareMenu(),"WEB"===_index2.default.getEnv()&&2===s.order.order_type&&(0,_index3.setShareContentInWeb)((0,_index3.getGroupBookingShareContent)(s)),_index2.default.hideLoading(),e.abrupt("return",s);case 23:e.prev=23,e.t0=e.catch(4),_index2.default.hideLoading();case 26:case"end":return e.stop()}},e,this,[[4,23]])}));return function(e){return r.apply(this,arguments)}}();exports.getShippingTypes=getShippingTypes;var _index=require("../../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_ajax=require("../../utils/ajax.js"),_ajax2=_interopRequireDefault(_ajax),_orderStatus=require("./order-status.js"),_index3=require("../../utils/compatibility/index.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function r(e,t){try{var n=s[e](t),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});a(i)}("next")})}}function getShippingTypes(){var r=this;return(0,_ajax2.default)({name:"getShippingTypes",success:function(e){r.setState({shippingTypes:e})}})}exports.default=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function e(r){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.$router.params.scene)return e.abrupt("return",getOrderInfoForVerifying.bind(this)(t));e.next=5;break;case 5:return e.abrupt("return",getOrderInfo.bind(this)(r));case 6:case"end":return e.stop()}},e,this)}));return function(e){return r.apply(this,arguments)}}();