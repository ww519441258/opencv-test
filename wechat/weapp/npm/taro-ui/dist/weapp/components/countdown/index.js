"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _class,_temp2,_createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),_get=function e(t,n,o){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,n);if(void 0===s){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in s)return s.value;var r=s.get;return void 0!==r?r.call(o):void 0},_index=require("../../../../../@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_index3=require("../../../../../prop-types/index.js"),_index4=_interopRequireDefault(_index3),_index5=require("../../../../../classnames/index.js"),_index6=_interopRequireDefault(_index5),_component=require("../../common/component.js"),_component2=_interopRequireDefault(_component);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var toSeconds=function(e,t,n,o){return 60*e*60*24+60*t*60+60*n+o},AtCountdown=(_temp2=_class=function(e){function r(){var e,t,n;_classCallCheck(this,r);for(var o=arguments.length,s=Array(o),i=0;i<o;i++)s[i]=arguments[i];return(t=n=_possibleConstructorReturn(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(s)))).$usedState=["anonymousState__temp","anonymousState__temp2","$compid__166","$compid__167","$compid__168","$compid__169","isShowDay","_day","_hours","_minutes","_seconds","day","hours","minutes","seconds","className","customStyle","format","isCard"],n.customComponents=["AtCountdownItem"],_possibleConstructorReturn(n,t)}return _inherits(r,_component2.default),_createClass(r,[{key:"_constructor",value:function(){_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"_constructor",this).apply(this,arguments);var e=this.props,t=e.day,n=e.hours,o=e.minutes,s=e.seconds;this.seconds=toSeconds(t,n,o,s),this.state={_day:t,_hours:n,_minutes:o,_seconds:s},this.timer=null,this.$$refs=[]}},{key:"setTimer",value:function(){this.timer||this.countdonwn()}},{key:"clearTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"countdonwn",value:function(){var e=this,t=0,n=0,o=0,s=0;if(0<this.seconds&&(t=Math.floor(this.seconds/86400),n=Math.floor(this.seconds/3600)-24*t,o=Math.floor(this.seconds/60)-24*t*60-60*n,s=Math.floor(this.seconds)-24*t*60*60-60*n*60-60*o),this.setState({_day:t,_hours:n,_minutes:o,_seconds:s}),this.seconds--,this.seconds<0)return this.clearTimer(),void this.props.onTimeUp();this.timer=setTimeout(function(){e.countdonwn()},1e3)}},{key:"componentWillReceiveProps",value:function(e){if(JSON.stringify(this.props)!==JSON.stringify(e)){var t=e.day,n=e.hours,o=e.minutes,s=e.seconds;this.seconds=toSeconds(t,n,o,s),this.clearTimer(),this.setTimer()}}},{key:"componentDidMount",value:function(){this.setTimer()}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"componentDidHide",value:function(){this.clearTimer()}},{key:"componentDidShow",value:function(){this.setTimer()}},{key:"_createData",value:function(){this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{};arguments[2];var e=this.$prefix,t=(0,_index.genCompid)(e+"$compid__166"),n=(0,_index.genCompid)(e+"$compid__167"),o=(0,_index.genCompid)(e+"$compid__168"),s=(0,_index.genCompid)(e+"$compid__169"),i=this.__props,r=i.className,a=i.customStyle,u=i.format,c=i.isShowDay,d=i.isCard,_=this.__state,p=_._day,l=_._hours,m=_._minutes,f=_._seconds,h=(0,_index6.default)({"at-countdown":!0,"at-countdown--card":d},r),y=(0,_index.internal_inline_style)(a);return c&&_index.propsManager.set({num:p,separator:u.day},t),_index.propsManager.set({num:l,separator:u.hours},n),_index.propsManager.set({num:m,separator:u.minutes},o),_index.propsManager.set({num:f,separator:u.seconds},s),Object.assign(this.__state,{anonymousState__temp:h,anonymousState__temp2:y,$compid__166:t,$compid__167:n,$compid__168:o,$compid__169:s,isShowDay:c}),this.__state}}]),r}(),_class.$$events=[],_class.$$componentPath="Users/vimcaw/Work/kcshop-taro/node_modules/taro-ui/dist/weapp/components/countdown/index",_temp2);AtCountdown.defaultProps={customStyle:"",className:"",isCard:!1,isShowDay:!1,format:{day:"天",hours:"时",minutes:"分",seconds:"秒"},day:0,hours:0,minutes:0,seconds:0,onTimeUp:function(){}},AtCountdown.propTypes={customStyle:_index4.default.oneOfType([_index4.default.object,_index4.default.string]),className:_index4.default.oneOfType([_index4.default.array,_index4.default.string]),isCard:_index4.default.bool,isShowDay:_index4.default.bool,format:_index4.default.object,day:_index4.default.number,hours:_index4.default.number,minutes:_index4.default.number,seconds:_index4.default.number,onTimeUp:_index4.default.func},exports.default=AtCountdown,Component(require("../../../../../@tarojs/taro-weapp/index.js").default.createComponent(AtCountdown));