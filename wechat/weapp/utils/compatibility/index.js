"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setShareContentInWeb=exports.login=void 0,exports.payViaWechat=payViaWechat,exports.getGroupBookingShareContent=getGroupBookingShareContent;var _index=require("../../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_helper=require("../helper.js"),_payViaWechat=require("./payViaWechat.js"),_login=require("./login.js"),_login2=_interopRequireDefault(_login);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.login=_login2.default;var wx=void 0;function payViaWechat(t){return new Promise(function(e,n){var o=function(){e()};"WEAPP"===_index2.default.getEnv()?(0,_payViaWechat.payViaWechatInWeapp)(t,o,n):(0,_payViaWechat.payViaWechatInWeb)(t,o,n)})}function getGroupBookingShareContent(e){if(!e)throw"getGroupBookingShareContent 的 orderInfo 参数不能为空";var n=e.goodsInfo[0].goods_name,o=e.order.regiment_id,t=e.regimentInfo.groupbooking_id;10<n.length&&(n=n.substr(0,10)+"...");var r="我正在拼【"+n+"】，求大家助力",i="/pages/goods-detail/goods-detail?"+("is_group_booking=1&id="+t+"&regiment_id="+o),a=e.goodsInfo[0].goods_img;return"WEAPP"===_index2.default.getEnv()?{title:r,path:i,imageUrl:a}:{title:window.title,desc:r,link:window.location.origin+"/#"+i,imgUrl:a}}var setShareContentInWeb=exports.setShareContentInWeb=function(e){var n=e.title,o=void 0===n?window&&window.title:n,t=e.desc,r=e.link,i=e.imgUrl,a=e.type,s=e.dataUrl;e.success,e.cancel;_index2.default.ajax({name:"getJsSdk",success:function(e){"string"==typeof e?wx.config(JSON.parse(e)):wx.config(e),wx.ready(function(){console.log("wx ready");var e={title:o,desc:t,link:r,imgUrl:i,type:a,dataUrl:s,success:function(){},cancel:function(){}};console.log("wx share content",e),wx.onMenuShareAppMessage(e),wx.onMenuShareTimeline(e),wx.onMenuShareQQ(e),wx.onMenuShareWeibo(e),wx.onMenuShareQZone(e),wx.updateAppMessageShareData(e),wx.updateTimelineShareData(e)}),wx.error(function(e){e.errMsg?(0,_helper.showError)(e.errMsg):(0,_helper.showError)(JSON.stringify(e))})}})};