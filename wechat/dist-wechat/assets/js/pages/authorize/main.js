(global.webpackJsonp=global.webpackJsonp||[]).push([[13],{253:function(t,e,n){"use strict";n.r(e);var i=n(254),r=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e.default=r.a},254:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=c(n(11)),r=c(n(136)),a=c(n(113)),u=c(n(23)),s=c(n(137)),o=c(n(12));function c(t){return t&&t.__esModule?t:{default:t}}e.default={mpType:"page",data:function(){return{isuser:!1,islocation:!1,options:{},url:"",start:0}},created:function(){var t=this;return(0,o.default)(i.default.mark(function e(){var n,o,c,f,l,d,h,p,v,g;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(wx.showLoading({title:"正在初始化",mask:!0}),t.options=wx.getLaunchOptionsSync(),n=[],o=!0,c=!1,f=void 0,e.prev=6,l=(0,a.default)((0,r.default)(t.options.query));!(o=(d=l.next()).done);o=!0)h=d.value,p=(0,s.default)(h,2),v=p[0],g=p[1],n.push({name:""+v,val:g});e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),c=!0,f=e.t0;case 14:e.prev=14,e.prev=15,!o&&l.return&&l.return();case 17:if(e.prev=17,!c){e.next=20;break}throw f;case 20:return e.finish(17);case 21:return e.finish(14);case 22:return 0==n.length&&(t.url="/"+t.options.path),n.forEach(function(e,n){0==n?t.url="/"+t.options.path+"?"+e.name+"="+e.val:t.url+="&"+e.name+"="+e.val}),t.$store.commit("setFullPath",t.url),e.next=27,new u.default(function(e,n){wx.login({success:function(i){i.code?t.$store.dispatch("getWxToken",i.code).then(function(){e(1)}):(wx.hideLoading(),wx.showLoading({title:"登录失败！"+i.errMsg,mask:!0}),n(1))}})});case 27:return e.next=29,new u.default(function(e,n){wx.getSetting({success:function(n){n.authSetting["scope.userInfo"]||(t.isuser=!0),e(1)}})});case 29:if(wx.hideLoading(),!t.isuser){e.next=32;break}return e.abrupt("return");case 32:t.redirectToFu();case 33:case"end":return e.stop()}},e,t,[[6,10,14,22],[15,,17,21]])}))()},methods:{getuserinfoFu:function(t){var e=this;"getUserInfo:ok"===t.detail.errMsg?(this.$store.commit("setUser",{nickname:t.detail.userInfo.nickName,avatar:t.detail.userInfo.avatarUrl}),this.$store.dispatch("userEdit",{nickname:t.detail.userInfo.nickName,avatar:t.detail.userInfo.avatarUrl}).then(function(t){1==t.status&&e.redirectToFu()})):wx.showToast({title:"请先同意授权!",icon:"loading",duration:1500,mask:!0})},redirectToFu:function(){wx.redirectTo({url:this.url})},startFu:function(){this.start=0},moveFu:function(){this.start=1},btnFu:function(){var t=this;1!=this.start&&wx.getLocation({type:"wgs84",success:function(e){t.$store.commit("setLatLng",{latitude:e.latitude,longitude:e.longitude}),setTimeout(function(){t.islocation=!1,t.isuser&&t.redirectToFu()},200)},fail:function(){wx.hideLoading(),wx.showToast({title:"地理获取失败！",icon:"loading",duration:1500,mask:!0}),t.islocation=!0}})}}}},367:function(t,e,n){"use strict";var i=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app",attrs:{_hid:0}},[this._ri(!!this.isuser,1)?e("button",{staticClass:"button",attrs:{"open-type":"getUserInfo",_hid:1},on:{getuserinfo:this.getuserinfoFu}},[]):this._e()],1)},r=[];i._withStripped=!0,n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r})},643:function(t,e,n){"use strict";var i=a(n(644)),r=a(n(17));function a(t){return t&&t.__esModule?t:{default:t}}i.default.mpType="page",new r.default(i.default).$mount()},644:function(t,e,n){"use strict";n.r(e);var i=n(367),r=n(253);for(var a in r)"default"!==a&&function(t){n.d(e,t,function(){return r[t]})}(a);n(645);var u=n(0),s=Object(u.a)(r.default,i.a,i.b,!1,null,"14dae750",null);s.options.__file="src/pages/authorize/index.vue",e.default=s.exports},645:function(t,e,n){"use strict";var i=n(854);n.n(i).a},854:function(t,e){}},[[643,0,1]]]);